#!/usr/bin/env python3

import sys
import json

log = lambda *x, **y: print(*x, **y, file=sys.stderr)

_current = json.load(sys.stdin)


def makedict(data):

    out = {}

    for cell in data:

        key = cell['ESSID'], cell['address'], cell['channel']
        value = cell['strength']

        out[key] = value

    return out

current = makedict(_current)
log(current)

args = sys.argv[1:]

candidates = []

def distance ( A , B ) :

    keys = set(A.keys()).union(B.keys())

    if not keys :
        return 0

    d = 0

    for key in keys :

        d += ( A.get( key , 0 ) - B.get( key , 0 ) )**2

    n = len(keys)

    return (d / n)**(1 / 2)



for arg in args:

    with open(arg) as _data:
        data = json.load(_data)

    tag = data['tag']
    _reference = data['fingerprint']
    reference = makedict(_reference)
    log(tag, reference)

    d = distance( current , reference )

    candidates.append((tag, d))

json.dump(sorted(candidates, key=lambda x: (x[1], x[0])), sys.stdout)
